<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Sender</title>
</head>
<body>
    <script>
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        const urlParams = new URLSearchParams(window.location.search);
        const name = urlParams.get('name');
        const phone = urlParams.get('phone');
        const answers = urlParams.get('answers');
        
        if (name && phone && answers) {
            try {
                const parsedAnswers = JSON.parse(decodeURIComponent(answers));
                
                const message = `üè† –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ —Å –∫–≤–∏–∑–∞ "–°–∞–º–æ–ª–µ—Ç –ú–ö–†"

üë§ –ò–º—è: ${name}
üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}

üìù –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
${parsedAnswers.map(item => `‚Ä¢ ${item.question}: ${item.answer}`).join('\n')}

‚è∞ –í—Ä–µ–º—è: ${new Date().toLocaleString('ru-RU')}`;

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram —á–µ—Ä–µ–∑ GET –∑–∞–ø—Ä–æ—Å
                const BOT_TOKEN = '8026350498:AAGcyKMsrJyD0mGgj26Ss2m49vX5jp8LzaM';
                const CHAT_ID = '919481169';
                const encodedMessage = encodeURIComponent(message);
                const telegramUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodedMessage}&parse_mode=HTML`;
                
                fetch(telegramUrl, {
                    method: 'GET',
                    mode: 'no-cors'
                }).then(() => {
                    // –£–≤–µ–¥–æ–º–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –æ–∫–Ω–æ –æ–± —É—Å–ø–µ—Ö–µ
                    if (window.parent) {
                        window.parent.postMessage({ success: true, message: '–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram' }, '*');
                    }
                }).catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
                    if (window.parent) {
                        window.parent.postMessage({ success: false, error: error.message }, '*');
                    }
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                if (window.parent) {
                    window.parent.postMessage({ success: false, error: error.message }, '*');
                }
            }
        } else {
            console.log('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏');
            if (window.parent) {
                window.parent.postMessage({ success: false, error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö' }, '*');
            }
        }
    </script>
</body>
</html>
